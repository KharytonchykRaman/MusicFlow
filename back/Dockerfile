# Обзываем base
FROM node:20-alpine AS base


# Залазим в /app внутри контейнера
WORKDIR /app 
# Копируем два файла из хоста в /app в контейнере
COPY ./package*.json ./
# Устанавливаем зависимости из package-lock.json (docker'у проще==быстрее отследить изменения пакетов)
RUN npm ci

# Заходим теперь в /app внутри контейнера (будет влиять на дальнейшие относительные птуи в контейнере)
WORKDIR /app     
# Копируем содержимое из текущего каталога на хосте по пути . (т.к. мы сейчас в src, то . — это и есть всё содержимое src)
# Скопируется в контейнер по пути app (т.к. выше мы задали WORKDIR /app как текущий каталог для выполнения действий)
COPY . .

# Объявляем порт, на котором будем завеодить сервер
EXPOSE 3000

# Команда, которая переопределится тем, что мы написали в docker-compose
CMD ["npm", "run", "dev"]